---
- name: Download Teamviwer version 10
  get_url: url="{{ tviewer_url }}" dest="{{ Downloads_prefix }}/teamviewer_i386.deb"

- name: Install Teamviwer
  apt: deb="{{ Downloads_prefix }}/teamviewer_i386.deb"

- name: Copy Tviewer script to destination system
  copy: src=tviewer_start.sh dest="{{ Downloads_prefix }}" mode=0774 force=yes

- name: Configure TViewer on the remote machine
  command: "{{ Downloads_prefix }}/tviewer_start.sh"

- name: Removing configuration file
  file: "{{ Downloads_prefix }}/tviewer_start.sh" state=absent

- name: reboot system
  shell: sleep 2 && shutdown -r now "Ansible package updates triggered"
  async: 1
  poll: 0
  ignore_errors: true

- name: waiting for server to come back
  local_action: wait_for port=22 host={{ inventory_hostname }} state=started
  delegate_to: 127.0.0.1
  sudo: false






